{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, withScopeId as _withScopeId, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\n_pushScopeId(\"data-v-41070577\");\n\nconst _hoisted_1 = {\n  id: \"svgD\"\n};\nconst _hoisted_2 = {\n  id: \"txD\"\n};\nconst _hoisted_3 = [\"y\"];\nconst _hoisted_4 = [\"dy\"];\n\n_popScopeId();\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"svg\", _hoisted_1, [_createElementVNode(\"text\", _hoisted_2, \"Select Mode:\" + _toDisplayString($options.matrixFlag), 1\n  /* TEXT */\n  ), _createElementVNode(\"rect\", {\n    x: \"0\",\n    y: $data.heightD - 50,\n    height: \"50\",\n    width: \"60\",\n    fill: \"orange\"\n  }, null, 8\n  /* PROPS */\n  , _hoisted_3), _createElementVNode(\"text\", {\n    dx: \"30\",\n    dy: $data.heightD - 17,\n    \"text-anchor\": \"middle\",\n    fill: \"white\",\n    \"font-size\": \"25\",\n    \"font-weight\": \"bold\"\n  }, \"B \", 8\n  /* PROPS */\n  , _hoisted_4)]);\n}","map":{"version":3,"sources":["C:\\Users\\admin\\Desktop\\WYSIWYG\\归档\\src\\components\\componentD.vue"],"names":[],"mappings":";;;;;AAES,EAAA,EAAE,EAAG;;;AACN,EAAA,EAAE,EAAG;;;;;;;;uBADT,mBAAA,CAkBG,KAlBH,EAAA,UAAA,EAkBG,CAjBL,mBAAA,CAAkD,MAAlD,EAAA,UAAA,EAAiB,iBAAY,gBAAA,CAAE,QAAA,CAAA,UAAF,CAA7B,EAAyC;AAAA;AAAzC,GAiBK,EAhBL,mBAAA,CAMM,MANN,EAMM;AALP,IAAA,CAAC,EAAG,GAKG;AAJN,IAAA,CAAC,EAAI,KAAA,CAAA,OAAA,GAAO,EAIN;AAHP,IAAA,MAAM,EAAG,IAGF;AAFP,IAAA,KAAK,EAAG,IAED;AADP,IAAA,IAAI,EAAG;AACA,GANN,E,IAAA,E;;AAAA,I,UAAA,CAgBK,EATN,mBAAA,CAQO,MARP,EAQO;AAPP,IAAA,EAAE,EAAG,IAOE;AANN,IAAA,EAAE,EAAI,KAAA,CAAA,OAAA,GAAO,EAMP;AALP,mBAAc,QAKP;AAJP,IAAA,IAAI,EAAG,OAIA;AAHP,iBAAY,IAGL;AAFP,mBAAc;AAEP,GARP,EAOC,IAPD,EAQA;AAAA;AARA,IAQA,UARA,CASM,CAlBH,C","sourcesContent":["<template>\n\t\n    <svg id = \"svgD\" >\n\t\t<text id = 'txD'>Select Mode:{{matrixFlag}}</text>\n\t\t<rect\n\tx = 0\n\t:y = 'heightD - 50'\n\theight = 50\n\twidth = 60\n\tfill = 'orange'>\n\t</rect>\n\t<text\n\tdx = 30\n\t:dy = 'heightD - 17'\n\ttext-anchor = 'middle'\n\tfill = 'white'\n\tfont-size = 25\n\tfont-weight = 'bold'\n\t>B\n\t</text>\n\t</svg>\n\n</template>\n\n<script>\nimport * as d3 from \"d3\"\n\n//import axios from 'axios'\n\nexport default {\n\tname: 'componentD',\n\tdata(){\n\t\treturn {\n\t\t\theightD:this.$store.state.height * 0.5,\n\t\t\twidthD:this.$store.state.width * 0.3,\n\t\t\thovered:'',\n\t\t\tnodesLength:0,\n\t\t\t\n\t\t}\n\t},\n\tmounted(){\n\t\td3.select(\"#txD\")\n\t\t.attr(\"dy\",70)\n\t\t.attr(\"dx\",this.widthD-150)\n\t\t.style(\"display\",'none')\n\t\t//console.log(this.$store.state.data_overall)\n\t\td3.select(\"#svgD\")\n\t\t.attr(\"width\",this.widthD)\n\t\t.attr(\"height\",this.heightD);\n\t\t\n\t\tthis.$store.commit({\n\t\t\ttype:'appendTitle',\n\t\t\tid:'DTitle',\n\t\t\tclass:'classD',\n\t\t\tsvg:'svgD',\n\t\t\tdx:'24px',\n\t\t\tdy:'36px',\n\t\t\tsize:'20px'\n\t\t\t\n\t\t})\n\t\t\n\t\tthis.$store.commit({\n\t\t\ttype:'appendBtn',\n\t\t\tsvgID:'svgD',\n\t\t\tbtnID:'Dbtn',\n\t\t\twidth:this.widthD,\n\t\t\ttext:'switch'\n\t\t})\n\t\t\n\t\td3.select(\"#svgD\").select(\"#Dbtn\")\n\t\t.on(\"click\",()=>{\n\t\t\tif(this.matrixFlag=='tree'){\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:'changeMatrixFlag',\n\t\t\t\t\tflag:'matrix'\n\t\t\t\t})\n\t\t\t\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:'changeMatrixFlag',\n\t\t\t\t\tflag:'tree'\n\t\t\t\t})\n\t\t\t\t\n\t\t\t}\n\t\t})\n\t\t.style(\"display\",'none')\n\t},\n\tcomputed:{\n\t\tmatrixElement1(){\n\t\t\treturn this.matrixElement+'1'\n\t\t},\n\t\tmatrixElement(){\n\t\t\treturn this.$store.state.matrixElement\n\t\t},\n\t\tmatrixFlag(){\n\t\t\treturn this.$store.state.matrixFlag\n\t\t},\n\t\ttreeTypeFlag(){\n\t\t\treturn this.$store.state.treeTypeFlag\n\t\t},\n\t\ttreeD(){\n\t\t\treturn this.treeData+'1'\n\t\t},\n\t\ttreeData(){\n\t\t\treturn this.$store.state.objB.treeData\n\t\t},\n\t\tcircled(){\n\t\t\treturn this.$store.state.objD.circled\n\t\t},\n\t\tcircledLength(){\n\t\t\treturn this.circled.length\n\t\t},\n\t\tD_title(){\n\t\t\treturn this.$store.state.objD.title\n\t\t},\n\t\tdata_overall(){\n\t\t\treturn this.$store.state.data_overall\n\t\t},\n\t\tleaf(){\n\t\t\treturn this.$store.state.leaf\n\t\t},\n\t\tselected(){\n\t\t\treturn this.$store.state.selected\n\t\t},\n\t\t\n\t\tcolorScale(){\n\t\t\treturn d3.scale.linear().domain([0,this.nodesLength]).range([\"#aaa7aa\",\"#4e7f78\"]);\n\t\t},\n\t},\n\tmethods:{\n\t\t\n\t\tD_TipRemove(){\n\t\t\td3.select(\"#svgD\").selectAll(\".tips\").remove()\n\t\t},\n\t\tD_createTip(d){\n\t\t\tfunction mouseXY(e){\n\t\t\t\t\t\t\te=e||window.event;\n\t\t\t\t\t\t\treturn { \"x\": e.offsetX, \"y\": e.offsetY };\n\t\t\t\t\t\t}\n\t\t\tlet XY = mouseXY(event);\n\t\t\t\n\t\t\td3.select(\"#svgD\").append(\"rect\")\n\t\t\t.attr(\"id\",\"tipBack\")\n\t\t\t.attr(\"class\",\"tips\")\n\t\t\t.attr(\"x\", XY.x+10)\n\t\t\t.attr(\"y\",XY.y-30)\n\t\t\t.style(\"width\",d.name.length *15 +10)\n\t\t\t.attr(\"rx\",20);\n\t\t\t\n\t\t\td3.select(\"#svgD\").append(\"text\")\n\t\t\t.attr(\"class\",\"tips\")\n\t\t\t.attr(\"dx\",XY.x+20)\n\t\t\t.attr(\"dy\",XY.y-5)\n\t\t\t.attr(\"text-anchor\",\"start\")\n\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t.attr(\"font-size\", \"14px\")\n\t\t\t.attr(\"font-weight\", \"bold\")\n\t\t\t.attr(\"fill\", \"white\")\n\t\t\t//.text(d.name)\n\t\t\t.text('company ***')\n\t\t\t\n\t\t\td3.select(\"#svgD\").append(\"text\")\n\t\t\t.attr(\"class\",\"tips\")\n\t\t\t.attr(\"dx\",XY.x+20)\n\t\t\t.attr(\"dy\",XY.y+15)\n\t\t\t.attr(\"text-anchor\",\"start\")\n\t\t\t.attr(\"font-family\", \"sans-serif\")\n\t\t\t.attr(\"font-size\", \"14px\")\n\t\t\t.attr(\"font-weight\", \"bold\")\n\t\t\t.attr(\"fill\", \"white\")\n\t\t\t.text('专利数:'+d.patent_num)\n\t\t},\n\t\tinner(x){\n\t\t\tlet D_nodes;\n\t\t\tlet inner = [];\n\t\t\tlet temp = [];\n\t\t\tlet indid = \"\";\n\t\t\tlet indname = \"\";\n\t\t\tfor(let i = 0;i<this.data_overall.length;i++){\n\t\t\t\tif(this.data_overall[i].name2 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name3 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name4 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name5 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name6 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name7 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t\telse if(this.data_overall[i].name8 == x){\n\t\t\t\t\ttemp.push({name:this.data_overall[i].comp_name,patent_num:this.data_overall[i].patent_num});\n\t\t\t\t\tindid = i+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(var i = 0;i<this.data_overall.length;i++){\n\t\t\t\tif(indid == this.data_overall[i].id){\n\t\t\t\t\tindname = this.data_overall[i].industry_name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tinner = {name:x,children:temp};\n\t\t\tconsole.log(\"indname\"+indname)\n\t\t\tlet r = this.widthD * 0.65;\n\t\t\t\n\t\t\tlet pack = d3.layout.pack()\n\t\t\t.size([r,r])\n\t\t\t.value(function(d){return d.patent_num});\n\t\t\t\n\t\t\tD_nodes = pack.nodes(inner);\n\t\t\tthis.nodesLength = D_nodes.length;\n\t\t\tD_nodes.sort(function(a,b){\n\t\t\t\treturn a.patent_num-b.patent_num\n\t\t\t}); \n\t\t\t//let color2 = d3.scale.linear().domain([0,D_nodes.length]).range([\"#aaa7aa\",\"#4e7f78\"]);\n\t\t\t//console.log(D_nodes)\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.data(D_nodes)\n\t\t\t.enter()\n\t\t\t.append(\"circle\")\n\t\t\t.attr(\"class\",\"classD\")\n\t\t\t.attr(\"id\",function(d){return d.name;})\n\t\t\t\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.data(D_nodes)\n\t\t\t.attr(\"transform\",\"translate(70,50)\")\n\t\t\t.attr(\"cx\",function(d){return d.x;})\n\t\t\t.attr(\"cy\",function(d){return d.y;})\n\t\t\t.attr(\"r\",function(d){return d.r;})\n\t\t\t.on(\"mouseover\",(d)=>{\n\t\t\t\tthis.hovered = d.name\n\t\t\t\tthis.D_TipRemove()\n\t\t\t\tthis.D_createTip(d)\n\t\t\t\t\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:'userMouseover',\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on(\"mousemove\",d=>{\n\t\t\t\tthis.D_TipRemove()\n\t\t\t\tthis.D_createTip(d)\n\t\t\t\n\t\t\t})\n\t\t\t.on(\"mouseout\",(d)=>{\n\t\t\t\tthis.hovered = ''\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.D_TipRemove()\n\t\t\t\t\t\t}, 1500);\n\t\t\t\t\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:'userMouseout',\n\t\t\t\t\tview:'viewD',\n\t\t\t\t\twidth:this.widthD,\n\t\t\t\t\theight:this.heightD,\n\t\t\t\t\tobj:'tips(company)',\n\t\t\t\t\tname:d.name + ':'+ this.selected,\n\t\t\t\t\tvalue:d.patent_num,\n\t\t\t\t\tdesc:'the patent number of ' + d.name + ' in ' + this.selected + ' is ' + d.patent_num,\n          data:{\n            industry:this.selected,\n            company:[d.name],\n            province:[],\n            attribute:'patent_num'\n          }\n\t\t\t\t})\n\t\t\t})\n\t\t\t.on(\"click\",(d)=>{\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:\"elementClear\",\n\t\t\t\t\tflag:'company'\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tthis.$store.commit({\n\t\t\t\t\ttype:'userClick',\n\t\t\t\t\tview:'viewD',\n\t\t\t\t\twidth:this.widthD,\n\t\t\t\t\theight:this.heightD,\n\t\t\t\t\tobj:'select company',\n\t\t\t\t\tname:d.name + ':'+ this.selected,\n\t\t\t\t\tvalue:d.patent_num,\n\t\t\t\t\tdesc:'the patent number of ' + d.name + ' in ' + this.selected + ' is ' + d.patent_num,\n          data:{\n            industry:this.selected,\n            company:[d.name],\n            province:[],\n            attribute:'patent_num'\n          }\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif(this.matrixFlag=='tree'){\n\t\t\t\t\tthis.$store.commit({\n\t\t\t\t\t\ttype:\"updateTreeData\",\n\t\t\t\t\t\t//treeTypeFlag :'company',\n\t\t\t\t\t\tname:d.name\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.$store.commit({\n\t\t\t\t\t\ttype : 'changeMatrixElement',\n\t\t\t\t\t\telement : d.name\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\t//console.log(this.$store.state.objD.circled)\n\t\t\t})\n\t\t\t.style(\"stroke\",\"none\")\n\t\t\t.style(\"stroke-width\",2)\n\t\t\t.style(\"fill\",\"white\")\n\t\t\t.transition().delay(function(d,i){return i+ d.r*3}).duration(500)\n\t\t\t.style(\"fill\",(d,i)=>{return d.patent_num?this.colorScale(i):\"none\";});\n\t\t\t\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.data(D_nodes)\n\t\t\t.exit()\n\t\t\t.remove()\n\t\t},\n\t\tale(){\n\t\t\t//console.log(this.$store.state.data_overall)\n\t\t}\n\t},\n\twatch:{\n\t\tleaf(val){\n\t\t\tif(val){\n\t\t\t\tthis.inner(this.selected);\n\t\t\t\td3.select(\"#Dbtn\")\n\t\t\t\t.style(\"display\",'inline')\n\t\t\t\td3.select(\"#txD\")\n\t\t\t\t.style(\"display\",'inline')\n\t\t\t}\n\t\t\telse{\n\t\t\t\td3.select(\"#svgD\")\n\t\t\t\t.selectAll(\"circle\")\n\t\t\t\t.remove();\n\t\t\t\td3.select(\"#DTitle\")\n\t\t\t\t.text('')\n\t\t\t\td3.select(\"#Dbtn\")\n\t\t\t\t.style(\"display\",'none')\n\t\t\t\td3.select(\"#txD\")\n\t\t\t\t.style(\"display\",'none')\n\t\t\t}\n\t\t},\n\t\tselected(val){\n\t\t\tif(this.leaf){\n\t\t\t\tthis.inner(val);\n\t\t\t\t\n\t\t\t}\n\t\t},\n\t\tD_title(val){\n\t\t\t//console.log(val)\n\t\t\tif(this.leaf){\n\t\t\t\td3.select(\"#DTitle\")\n\t\t\t\t.text(val + '产业包含企业情况')\n\t\t\t}\n\t\t},\n\t\thovered(val){\n\t\t\t\n\t\t\t\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.filter(d=>d.name != val)\n\t\t\t.style(\"fill\",(d,i)=>{return d.patent_num?this.colorScale(i):\"none\";});\n\t\t\t\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.filter(d=>this.treeData.indexOf(d.name) != -1)\n\t\t\t.style(\"fill\",'#25f4ff')\n\t\t\t\n\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t.filter(d=>{return d.name == val && d.depth!= 0})\n\t\t\t.style(\"fill\",\"red\");\n\t\t},\n\t\t\n\t\ttreeD(){\n\t\n\t\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t\t.filter(d=>this.treeData.indexOf(d.name) != -1)\n\t\t\t\t.style(\"fill\",'#25f4ff')\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\td3.select(\"#svgD\").selectAll(\"circle\")\n\t\t\t\t.filter(d=>this.treeData.indexOf(d.name) == -1)\n\t\t\t\t.style(\"fill\",(d,i)=>{return d.patent_num?this.colorScale(i):\"none\";});\n\t\t\t\t\n\t\t},\n\t\tmatrixElement1(){\n\t\t\td3.selectAll(\"#svgD\").selectAll(\"circle\")\n\t\t\t.filter(d=>{\n\t\t\t\tif(this.matrixElement.indexOf(d.name) != -1){\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t})\n\t\t\t.style(\"stroke\",\"red\");\n\t\t\t\n\t\t\td3.selectAll(\"#svgD\").selectAll(\"circle\")\n\t\t\t.filter(d=>{\n\t\t\t\tif(this.matrixElement.indexOf(d.name) == -1){\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t})\n\t\t\t.style(\"stroke\",\"none\")\n\t\t}\n\t\t\n\t}\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}